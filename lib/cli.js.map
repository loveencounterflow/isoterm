{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/cli.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n\n\n'use strict'\n\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'XTERM'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nPATH                      = require 'path'\nCP                        = require 'child_process'\n#...........................................................................................................\nxterm_path                = PATH.resolve PATH.join __dirname, '../xterm'\nstart_path                = PATH.resolve PATH.join __dirname, '../app/start.js'\nH                         = require './helpers'\nport_pattern              = /^33[0-9]{3}$/\n# port_pattern              = /^8081$/\nGUY                       = require 'guy'\n\n\n#-----------------------------------------------------------------------------------------------------------\nget_screen_dimensions = ->\n  [ width, height, ] = ( require '@vamidicreations/screenres' ).get()\n  return { width, height, }\n\n#-----------------------------------------------------------------------------------------------------------\nparse_arguments = ->\n  if process.argv.length isnt 2\n    warn \"^445-1^ this command doesn't accept parameters; terminating\"\n    process.exit 1\n\n#-----------------------------------------------------------------------------------------------------------\nstart_server = -> new Promise ( resolve, reject ) =>\n  port    = null\n  host    = '127.0.0.1'\n  signals =\n    webpack:    false\n    server:     false\n    browser:    false\n  #.........................................................................................................\n  conclude = ( signal ) =>\n    signals[ signal ] = true\n    if signals.webpack and signals.server and ( not signals.browser )\n      signals.browser = true\n      resolve { server, host, port, }\n  #.........................................................................................................\n  process.chdir xterm_path\n  port              = await H.find_free_port { port: port_pattern, fallback: null, }\n  env               = { process.env..., xxterm_host: host, xxterm_port: port, }\n  cp_cfg            = { detached: false, env, }\n  # cp_cfg            = { detached: false, }\n  process.on 'uncaughtException', ( error ) =>\n    warn '^cli/server@445-2^', error\n    process.exit 99\n  try\n    server            = CP.fork start_path, cp_cfg\n  catch error\n    warn '^445-3^', error\n  # server.stderr.on 'data', ( data ) => warn '^445-4^', CND.reverse data\n  # server.stdout.on 'data', ( data ) => info '^445-5^', CND.reverse data\n  # debug '^5345^', server.stderr.toString().trim()\n  #.........................................................................................................\n  server.on 'error', ( error ) => warn '^cli/server@445-6^', error\n  #.........................................................................................................\n  server.on 'message', ( d ) =>\n    # info '^cli/server@445-7^', d\n    switch d?.$key ? null\n      when '^connect'\n        help \"^cli/server@445-8^ serving on port #{rpr d.port}\"\n        conclude 'server'\n      when '^webpack-ready'\n        help \"^cli/server@445-9^ webpack ready\"\n        conclude 'webpack'\n      when '^term-pid'\n        help \"^cli/server@445-10^ received terminal PID #{d.pid}\"\n        demo_websocket host, port, d.pid\n      else\n        warn \"^cli/server@445-11^ unknown message format: #{rpr d}\"\n    return null\n  #.........................................................................................................\n  server.on 'close',      => whisper '^cli/server@445-12^', 'close'\n  server.on 'disconnect', => whisper '^cli/server@445-13^', 'disconnect'\n  server.on 'error',      => whisper '^cli/server@445-14^', 'error'\n  server.on 'message',    => whisper '^cli/server@445-15^', 'message'\n  server.on 'spawn',      => whisper '^cli/server@445-16^', 'spawn'\n  server.on 'exit',       => whisper '^cli/server@445-17^', 'exit'; process.exit 0\n  #.........................................................................................................\n  GUY.process.on_exit ->\n    info CND.reverse \" ^409-1^ process exiting; terminating server process PID #{server.pid} \"\n    server.kill()\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\nstart_browser = ( cfg ) -> new Promise ( resolve, reject ) =>\n  defaults    = { server: null, host: null, port: null, }\n  { server\n    host\n    port }    = { defaults..., cfg..., }\n  cmd         = 'chromium'\n  ### TAINT get address from `start_server()` ###\n  address     = \"http://#{host}:#{port}\"\n  screen      = get_screen_dimensions()\n  parameters  = [ \"--app=#{address}\", \"--window-position=0,0\", \"--window-size=#{screen.width},#{screen.height}\", ]\n  # parameters  = [ \"--app=#{address}\", ]\n  cp_cfg      = { detached: false, }\n  help '^cli/browser@445-18^', \"spawning #{cmd} #{parameters.join ' '}\"\n  browser     = CP.spawn cmd, parameters, cp_cfg\n  browser.on 'error', ( error ) => warn '^cli/browser@445-19^', error\n  browser.on 'close',       => whisper '^cli/browser@445-20^', 'close'\n  browser.on 'disconnect',  => whisper '^cli/browser@445-21^', 'disconnect'\n  browser.on 'error',       => whisper '^cli/browser@445-22^', 'error'\n  browser.on 'message',     => whisper '^cli/browser@445-23^', 'message'\n  browser.on 'spawn',       => whisper '^cli/browser@445-24^', 'spawn'\n  browser.on 'exit',        => whisper '^cli/browser@445-25^', 'exit'; process.exit 0\n  #.........................................................................................................\n  GUY.process.on_exit ->\n    info CND.reverse \" ^cli/browser@445-26^ process exiting; terminating browser process PID #{browser.pid} \"\n    browser.kill()\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\nrun = ->\n  parse_arguments()\n  { server, host, port, } = await start_server()\n  { browser, }            = await start_browser { server, host, port, }\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\ndemo_websocket = ( host, port, pid ) =>\n  url     = \"ws://#{host}:#{port}/terminals/#{pid}\"\n  WS      = require 'ws'\n  ws      = new WS.WebSocket url\n  ws.on 'open', () =>\n    urge \"^cli/demo_websocket@445-27^ websocket open at #{url}\"\n    # ws.send 'echo \"helo from server\"'\n  # ws.on 'message', ( data ) =>\n  #   if cfg.echo\n  #     process.stdout.write data # .toString()\n  return null\n\n\n############################################################################################################\ndo =>\n  # GUY.process.on_exit ->\n  #   info CND.reverse \" ^409-7^ process exiting \"\n  await run()\n\n"
  ]
}